!function(e,n){"object"==typeof module&&"object"==typeof module.exports?module.exports=n(e,!0):"function"==typeof define&&define.amd?define((function(){return n(e,!0)})):n(e)}("undefined"!=typeof window?window:this,(function(e,n){"use strict";function t(e){return"function"==typeof e||e instanceof Element?e:void 0}function i(e){var n=0===e.index&&e.isEnd?"biaodian cjk":"biaodian cjk portion "+(0===e.index?"is-first":e.isEnd?"is-end":"is-inner"),t=Ee.create("h-char-group",n);return t.innerHTML=e.text,t}function r(e){var n=Ee.create("div"),t=e.charCodeAt(0).toString(16);return n.innerHTML='<h-char unicode="'+t+'" class="biaodian cjk '+a(e)+'">'+e+"</h-char>",n.firstChild}function a(e){return e.match(_.char.biaodian.open)?"bd-open":e.match(_.char.biaodian.close)?"bd-close bd-end":e.match(_.char.biaodian.end)?/(?:\u3001|\u3002|\uff0c)/i.test(e)?"bd-end bd-cop":"bd-end":e.match(new RegExp(U.biaodian.liga))?"bd-liga":e.match(new RegExp(U.biaodian.middle))?"bd-middle":""}function o(e,n){var t=Ee.create("canvas"),i;return t.width="50",t.height="20",t.style.display="none",O.appendChild(t),(i=t.getContext("2d")).textBaseline="top",i.font="15px "+n+", sans-serif",i.fillStyle="black",i.strokeStyle="black",i.fillText(e,0,0),{node:t,context:i,remove:function(){Ee.remove(t,O)}}}function c(e,n){var t,i=e.context,r=n.context;try{for(var a=1;a<=20;a++)for(var o=1;o<=50;o++){if(void 0===t&&i.getImageData(o,a,1,1).data[3]!==r.getImageData(o,a,1,1).data[3]){t=!1;break}if("boolean"==typeof t)break;50===o&&20===a&&void 0===t&&(t=!0)}return e.remove(),n.remove(),e=null,n=null,t}catch(e){}return!1}function s(e,n,t){var e=e,n,t,i;return n=o(t=t||"辭Q",n=n||"sans-serif"),!c(e=o(t,e),n)}function d(e){var n=Ee.create("!"),t=e.classList,i,r;return n.appendChild(Ee.clone(e)),Ee.tag("rt",n.firstChild).forEach((function(e){var n=Ee.create("!"),i=[],a;do{if(!(a=(a||e).previousSibling)||a.nodeName.match(/((?:h\-)?r[ubt])/i))break;n.insertBefore(Ee.clone(a),n.firstChild),i.push(a)}while(!a.nodeName.match(/((?:h\-)?r[ubt])/i));r=t.contains("zhuyin")?g(n,e):f(n,e);try{e.parentNode.replaceChild(r,e),i.map(Ee.remove)}catch(e){}})),h(n)}function u(e){var n=Ee.create("!");return n.appendChild(Ee.clone(e)),Ee.tag("rt",n.firstChild).forEach((function(e){var n=Ee.create("!"),t=[],i,r;do{if(!(i=(i||e).previousSibling)||i.nodeName.match(/((?:h\-)?r[ubt])/i))break;n.insertBefore(Ee.clone(i),n.firstChild),t.push(i)}while(!i.nodeName.match(/((?:h\-)?r[ubt])/i));(r=Ee.create("rt")).innerHTML=b(e),e.parentNode.replaceChild(r,e)})),n.firstChild}function l(e){var n=Ee.create("!"),t=e.classList,i,r,a,o,c;return n.appendChild(Ee.clone(e)),i=n.firstChild,r=a=Ee.tag("rb",i),o=r.length,(c=i.querySelector("rtc.zhuyin"))&&(a=Ee.tag("rt",c).map((function(e,n){if(r[n]){var t=g(r[n],e);try{r[n].parentNode.replaceChild(t,r[n])}catch(e){}return t}})),Ee.remove(c),i.setAttribute("rightangle","true")),Ee.qsa("rtc:not(.zhuyin)",i).forEach((function(e,n){var r;r=Ee.tag("rt",e).map((function(e,i){var r=Number(e.getAttribute("rbspan")||1),c=0,s=[],d,u;r>o&&(r=o);do{try{d=a.shift(),s.push(d)}catch(e){}if(void 0===d)break;c+=Number(d.getAttribute("span")||1)}while(r>c);if(r<c){if(s.length>1)return;s=Ee.tag("rb",s[0]),a=s.slice(r).concat(a),s=s.slice(0,r),c=r}u=f(s,e,{class:t,span:c,order:n});try{s[0].parentNode.replaceChild(u,s.shift()),s.map(Ee.remove)}catch(e){}return u})),a=r,1===n&&i.setAttribute("doubleline","true"),Ee.remove(e)})),h(n)}function h(e){var n=e.firstChild,t=Ee.create("h-ruby");return t.innerHTML=n.innerHTML,Ee.setAttr(t,n.attributes),t.normalize(),t}function p(e){if(!e instanceof Element)return e;var n=e.classList;return n.contains("pinyin")?n.add("romanization"):n.contains("romanization")?n.add("annotation"):n.contains("mps")?n.add("zhuyin"):n.contains("rightangle")&&n.add("complex"),e}function f(e,n,t){var i=Ee.create("h-ru"),n=Ee.clone(n),t;return(t=t||{}).annotation="true",Array.isArray(e)?i.innerHTML=e.map((function(e){return void 0===e?"":e.outerHTML})).join("")+n.outerHTML:(i.appendChild(Ee.clone(e)),i.appendChild(n)),Ee.setAttr(i,t),i}function g(e,n){var e=Ee.clone(e),t=Ee.create("h-ru");return t.setAttribute("zhuyin",!0),t.appendChild(e),t.innerHTML+=b(n),t}function b(e){var n="string"==typeof e?e:e.textContent,t,i,r;return r=(t=n.replace(_.zhuyin.diao,""))?t.length:0,i=n.replace(t,"").replace(/[\u02C5]/g,"ˇ").replace(/[\u030D\u0358]/g,"̇"),0===r?"":'<h-zhuyin length="'+r+'" diao="'+i+'"><h-yin>'+t+"</h-yin><h-diao>"+i+"</h-diao></h-zhuyin>"}function v(e,n){return e&&n&&e.parentNode===n.parentNode}function m(e,n){var t=e,n=n||"";if(Ee.isElmt(e.nextSibling)||v(e,e.nextSibling))return n+Le;for(;!t.nextSibling;)t=t.parentNode;return e!==t&&t.insertAdjacentHTML("afterEnd","<h-hws hidden> </h-hws>"),n}function y(e,n){return e.isEnd&&0===e.index?n[1]+Le+n[2]:0===e.index?m(e.node,e.text):e.text}function x(e){return 0===e.index?Ee.clone(ke):""}function E(e){var n=e.node.parentNode;return 0===e.index&&(ze=e.endIndexInNode-2),"h-hws"!==n.nodeName.toLowerCase()||1!==e.index&&e.indexInMatch!==ze||n.classList.add("quote-inner"),e.text}function w(e){var n=e.node.parentNode;return"h-hws"===n.nodeName.toLowerCase()&&n.classList.add("quote-outer"),e.text}function N(){var e=Ee.create("div"),n;return e.innerHTML="<span>a b</span><span style=\"font-family: 'Han Space'\">a b</span>",O.appendChild(e),n=e.firstChild.offsetWidth!==e.lastChild.offsetWidth,Ee.remove(e),n}function C(e){var n=e.nextSibling;n&&je(n,"h-cs.jinze-outer")?n.classList.add("hangable-outer"):e.insertAdjacentHTML("afterend",Re)}function T(e){return e.replace(/(biaodian|cjk|bd-jiya|bd-consecutive|bd-hangable)/gi,"").trim()}function S(e){var n=e.text,t=e.node.parentNode,i=Ee.parent(t,"h-char.biaodian"),r=F.createBDChar(n),a;return r.innerHTML="<h-inner>"+n+"</h-inner>",r.classList.add(Ae),(a=Ee.parent(t,"h-jinze"))&&k(a),i?(i.classList.add(Ae),je(t,"h-inner, h-inner *")?n:r.firstChild):r}function L(e){var n=Be,t=e.node.parentNode,i=Ee.parent(t,"h-char.biaodian"),r=Ee.parent(i,"h-jinze"),a;return a=i.classList,n&&i.setAttribute("prev",n),De&&a.contains("bd-open")&&De.pop().setAttribute("next","bd-open"),De=void 0,e.isEnd?(Be=void 0,a.add(He,"end-portion")):(Be=T(i.getAttribute("class")),a.add(He)),r&&(De=z(r,{prev:n,class:T(i.getAttribute("class"))})),e.text}function k(e){je(e,".tou, .touwei")&&!je(e.previousSibling,"h-cs.jiya-outer")&&e.insertAdjacentHTML("beforebegin",Oe),je(e,".wei, .touwei")&&!je(e.nextSibling,"h-cs.jiya-outer")&&e.insertAdjacentHTML("afterend",Oe)}function z(e,n){var t,i;return je(e,".tou, .touwei")&&(t=e.previousSibling,je(t,"h-cs")&&(t.className="jinze-outer jiya-outer",t.setAttribute("prev",n.prev))),je(e,".wei, .touwei")&&(i=e.nextSibling,je(i,"h-cs")&&(i.className="jinze-outer jiya-outer "+n.class,i.removeAttribute("prev"))),[t,i]}function I(e,n,t){return function(){var i=F.localize.writeOnCanvas(n,e),r=F.localize.writeOnCanvas(t,e);return F.localize.compareCanvases(i,r)}}function M(){return I('"Romanization Sans"',"a̍","󰁡")}function R(){return I('"Romanization Sans"',"i̍","󰁩")}function j(){return I('"Zhuyin Kaiti"',"ㆴ̇","󳆴")}function A(e){return function(n){var n=n||P,t=F.find(n).avoid(qe);return e.forEach((function(e){t.replace(new RegExp(e[0],"ig"),(function(n,t){var i=Ee.clone(Ue);return i.innerHTML="<h-inner>"+t[0]+"</h-inner>",i.setAttribute("display-as",e[1]),0===n.index?i:""}))})),t}}var P=e.document,H=P.documentElement,O=P.body,B="3.3.0",D=["initCond","renderElem","renderJiya","renderHanging","correctBiaodian","renderHWS","substCombLigaWithPUA"],F=function(e,n){return new F.fn.init(e,n)},q=function(e,n){return e&&(this.context=e),n&&(this.condition=n),this};F.version=B,F.fn=F.prototype={version:B,constructor:F,context:O,condition:H,routine:D,init:q,setRoutine:function(e){return Array.isArray(e)&&(this.routine=e),this},render:function(e){var n=this,e;return(e=Array.isArray(e)?e:this.routine).forEach((function(e){"string"==typeof e&&"function"==typeof n[e]?n[e]():Array.isArray(e)&&"function"==typeof n[e[0]]&&n[e.shift()].apply(n,e)})),this}},F.fn.init.prototype=F.fn,F.init=function(){return F.init=F().render()};var U={punct:{base:"[…,.;:!?‽_]",sing:"[‐-—…]",middle:"[\\/~\\-&‐-—_]",open:"['\"‘“\\(\\[¡¿⸘«‹‚“„]",close:"['\"”’\\)\\]»›‛”‟]",end:"['\"”’\\)\\]»›‛”‟‼‽⁇-⁉,.;:!?]"},biaodian:{base:"[︰．、，。：；？！ー]",liga:"[—…⋯]",middle:"[·＼／－゠＆・＿]",open:"[「『《〈（〔［｛【〖]",close:"[」』》〉）〕］｝】〗]",end:"[」』》〉）〕］｝】〗︰．、，。：；？！ー]"},hanzi:{base:"[一-鿿㐀-䶵㇀-㇣〇﨎﨏﨑﨓﨔﨟﨡﨣﨤﨧-﨩]|[\ud800-\udbff][\udc00-\udfff]",desc:"[⿰-⿺]",radical:"[⼀-⿕⺀-⻳]"},latin:{base:"[A-Za-z0-9À-ÿĀ-ſƀ-ɏⱠ-Ɀ꜠-ꟿḀ-ỿ]",combine:"[̀-́᷀-᷿]"},ellinika:{base:"[0-9Ͱ-Ͽἀ-῿]",combine:"[̀-᷀ͅ-᷿]"},kirillica:{base:"[0-9Ѐ-҂Ҋ-ӿԀ-ԯꙀ-ꙮ꙾-ꚗ]",combine:"[҃-҉ⷠ-ⷿ꙯-꙽ꚟ]"},kana:{base:"[アイウエオ-ヺあいうえお-ゔゟヿ]|\ud82c[\udc00-\udc01]",small:"[ぁぃぅぇぉァィゥェォっゃゅょゎゕゖッャュョヮヵヶㇰ-ㇿ]",combine:"[゙-゜]",half:"[ｦ-ﾟ]",mark:"[゠ゝゞ・-ヾ]"},eonmun:{base:"[가-힣]",letter:"[ᄀ-ᇿㅏ-ㅣㄱ-ㆎꥠ-ꥼힰ-ퟻ]",half:"[ﾡ-ￜ]"},zhuyin:{base:"[ㄅ-ㄭㆠ-ㆺ]",initial:"[ㄅ-ㄙㄪ-ㄬㆠ-ㆣ]",medial:"[ㄧ-ㄩ]",final:"[ㄚ-ㄩㄭㆤ-ㆳㆸ-ㆺ]",tone:"[˙ˊ˅ˇˋ˪˫]",checked:"[ㆴ-ㆷ][̇̍͘]?"}},_=(Y="[\\x20\\t\\r\\n\\f]",W=U.punct.open,V=U.punct.close,Z=U.punct.end,$=U.punct.middle,J=U.punct.sing,G=W+"|"+Z+"|"+$,K=U.biaodian.open,Q=U.biaodian.close,X=U.biaodian.end,ee=U.biaodian.middle,ne=U.biaodian.liga+"{2}",te=K+"|"+X+"|"+ee,ie=U.kana.base+U.kana.combine+"?",re=U.kana.small+U.kana.combine+"?",ae=U.kana.half,oe=U.eonmun.base+"|"+U.eonmun.letter,ce=U.eonmun.half,se=U.hanzi.base+"|"+U.hanzi.desc+"|"+U.hanzi.radical+"|"+ie,de=U.ellinika.combine,ue=U.latin.base+de+"*",le=U.ellinika.base+de+"*",he=U.kirillica.combine,pe=U.kirillica.base+he+"*",ge="['’]",be=se+"|(?:"+(fe=ue+"|"+le+"|"+pe)+"|['’])+",ve=U.zhuyin.initial,me=U.zhuyin.medial,ye=U.zhuyin.final,xe=U.zhuyin.tone+"|"+U.zhuyin.checked,{char:{punct:{all:new RegExp("("+G+")","g"),open:new RegExp("("+W+")","g"),end:new RegExp("("+Z+")","g"),sing:new RegExp("("+J+")","g")},biaodian:{all:new RegExp("("+te+")","g"),open:new RegExp("("+K+")","g"),close:new RegExp("("+Q+")","g"),end:new RegExp("("+X+")","g"),liga:new RegExp("("+ne+")","g")},hanzi:new RegExp("("+se+")","g"),latin:new RegExp("("+ue+")","ig"),ellinika:new RegExp("("+le+")","ig"),kirillica:new RegExp("("+pe+")","ig"),kana:new RegExp("("+ie+"|"+re+"|"+ae+")","g"),eonmun:new RegExp("("+oe+"|"+ce+")","g")},group:{biaodian:[new RegExp("(("+te+"){2,})","g"),new RegExp("("+ne+K+")","g")],punct:null,hanzi:new RegExp("("+se+")+","g"),western:new RegExp("("+ue+"|"+le+"|"+pe+"|"+G+")+","ig"),kana:new RegExp("("+ie+"|"+re+"|"+ae+")+","g"),eonmun:new RegExp("("+oe+"|"+ce+"|"+G+")+","g")},jinze:{hanging:new RegExp(Y+"*([、，。．])(?!"+X+")","ig"),touwei:new RegExp("("+K+"+)("+be+")("+X+"+)","ig"),tou:new RegExp("("+K+"+)("+be+")","ig"),wei:new RegExp("("+be+")("+X+"+)","ig"),middle:new RegExp("("+be+")("+ee+")("+be+")","ig")},zhuyin:{form:new RegExp("^˙?("+ve+")?("+me+")?("+ye+")?("+xe+")?$"),diao:new RegExp("("+xe+")","g")},hws:{base:[new RegExp("("+se+")("+fe+"|"+W+")","ig"),new RegExp("("+fe+"|"+Z+")("+se+")","ig")],strict:[new RegExp("("+se+")"+Y+"?("+fe+"|"+W+")","ig"),new RegExp("("+fe+"|"+Z+")"+Y+"?("+se+")","ig")]},"display-as":{"ja-font-for-hant":["查 査","啟 啓","鄉 鄕","值 値","污 汚"],"comb-liga-pua":[["a[̍͘]","󰁡"],["e[̍͘]","󰁥"],["i[̍͘]","󰁩"],["o[̍͘]","󰁯"],["u[̍͘]","󰁵"],["ㆴ[̇̍͘]","󳆴"],["ㆵ[̇̍͘]","󳆵"],["ㆶ[̇̍͘]","󳆶"],["ㆷ[̇̍͘]","󳆷"]],"comb-liga-vowel":[["a[̍͘]","󰁡"],["e[̍͘]","󰁥"],["i[̍͘]","󰁩"],["o[̍͘]","󰁯"],["u[̍͘]","󰁵"]],"comb-liga-zhuyin":[["ㆴ[̇̍͘]","󳆴"],["ㆵ[̇̍͘]","󳆵"],["ㆶ[̇̍͘]","󳆶"],["ㆷ[̇̍͘]","󳆷"]]},"inaccurate-char":[["[•‧]","·"],["⋯⋯","……"],["──","——"],["‵","‘"],["′","’"],["‶","“"],["″","”"]]}),Y,W,V,Z,$,J,G,K,Q,X,ee,ne,te,ie,re,ae,oe,ce,se,de,ue,le,he,pe,fe,ge,be,ve,me,ye,xe;F.UNICODE=U,F.TYPESET=_,F.UNICODE.cjk=F.UNICODE.hanzi,F.UNICODE.greek=F.UNICODE.ellinika,F.UNICODE.cyrillic=F.UNICODE.kirillica,F.UNICODE.hangul=F.UNICODE.eonmun,F.UNICODE.zhuyin.ruyun=F.UNICODE.zhuyin.checked,F.TYPESET.char.cjk=F.TYPESET.char.hanzi,F.TYPESET.char.greek=F.TYPESET.char.ellinika,F.TYPESET.char.cyrillic=F.TYPESET.char.kirillica,F.TYPESET.char.hangul=F.TYPESET.char.eonmun,F.TYPESET.group.hangul=F.TYPESET.group.eonmun,F.TYPESET.group.cjk=F.TYPESET.group.hanzi;var Ee={id:function(e,n){return(n||P).getElementById(e)},tag:function(e,n){return this.makeArray((n||P).getElementsByTagName(e))},qs:function(e,n){return(n||P).querySelector(e)},qsa:function(e,n){return this.makeArray((n||P).querySelectorAll(e))},parent:function(e,n){return n?function(){if("function"==typeof Ee.matches){for(;!Ee.matches(e,n);){if(!e||e===P.documentElement){e=void 0;break}e=e.parentNode}return e}}():e?e.parentNode:void 0},create:function(e,n){var t="!"===e?P.createDocumentFragment():""===e?P.createTextNode(n||""):P.createElement(e);try{n&&(t.className=n)}catch(e){}return t},clone:function(e,n){return e.cloneNode("boolean"!=typeof n||n)},remove:function(e){return e.parentNode.removeChild(e)},setAttr:function(e,n){if("object"==typeof n){var t=n.length;if("object"==typeof n[0]&&"name"in n[0])for(var i=0;i<t;i++)void 0!==n[i].value&&e.setAttribute(n[i].name,n[i].value);else for(var r in n)n.hasOwnProperty(r)&&void 0!==n[r]&&e.setAttribute(r,n[r]);return e}},isElmt:function(e){return e&&e.nodeType===Node.ELEMENT_NODE},isIgnorable:function(e){return!!e&&("WBR"===e.nodeName||e.nodeType===Node.COMMENT_NODE)},makeArray:function(e){return Array.prototype.slice.call(e)},extend:function(e,n){if(("object"==typeof e||"function"==typeof e)&&"object"==typeof n)for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e}},we=function(n){function t(e,n,t){var i=Element.prototype,r=i.matches||i.mozMatchesSelector||i.msMatchesSelector||i.webkitMatchesSelector;return e instanceof Element?r.call(e,n):!(!t||!/^[39]$/.test(e.nodeType))}var i="0.2.1",r=n.NON_INLINE_PROSE,a=n.PRESETS.prose.filterElements,o,c=(e||{}).document||void 0;if(void 0===c)throw new Error("Fibre requires a DOM-supported environment.");var s=function(e,n){return new s.fn.init(e,n)};return s.version=i,s.matches=t,s.fn=s.prototype={constructor:s,version:i,finder:[],context:void 0,portionMode:"retain",selector:{},preset:"prose",init:function(e,n){if(n&&(this.preset=null),this.selector={context:null,filter:[],avoid:[],boundary:[]},!e)throw new Error("A context is required for Fibre to initialise.");return e instanceof Node?e instanceof Document?this.context=e.body||e:this.context=e:"string"==typeof e&&(this.context=c.querySelector(e),this.selector.context=e),this},filterFn:function(e){var n=this.selector.filter.join(", ")||"*",i=this.selector.avoid.join(", ")||null,r=t(e,n,!0)&&!t(e,i);return"prose"===this.preset?a(e)&&r:r},boundaryFn:function(e){var n,i=t(e,this.selector.boundary.join(", ")||null);return"prose"===this.preset&&r(e)||i},filter:function(e){return"string"==typeof e&&this.selector.filter.push(e),this},endFilter:function(e){return e?this.selector.filter=[]:this.selector.filter.pop(),this},avoid:function(e){return"string"==typeof e&&this.selector.avoid.push(e),this},endAvoid:function(e){return e?this.selector.avoid=[]:this.selector.avoid.pop(),this},addBoundary:function(e){return"string"==typeof e&&this.selector.boundary.push(e),this},removeBoundary:function(){return this.selector.boundary=[],this},setMode:function(e){return this.portionMode="first"===e?"first":"retain",this},replace:function(e,t){var i=this;return i.finder.push(n(i.context,{find:e,replace:t,filterElements:function(e){return i.filterFn(e)},forceContext:function(e){return i.boundaryFn(e)},portionMode:i.portionMode})),i},wrap:function(e,t){var i=this;return i.finder.push(n(i.context,{find:e,wrap:t,filterElements:function(e){return i.filterFn(e)},forceContext:function(e){return i.boundaryFn(e)},portionMode:i.portionMode})),i},revert:function(e){var n=this.finder.length,e=Number(e)||(0===e?Number(0):"all"===e?n:1);if(void 0===n||0===n)return this;e>n&&(e=n);for(var t=e;t>0;t--)this.finder.pop().revert();return this}},s.fn.filterOut=s.fn.avoid,s.fn.init.prototype=s.fn,s}(function(){function e(e){return"[object Array]"==d.call(e)}function n(e){return String(e).replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")}function t(){return i.apply(null,arguments)||r.apply(null,arguments)}function i(e,n,i,a,o){if(n&&!n.nodeType&&arguments.length<=2)return!1;var c="function"==typeof i,s;c&&(s=i,i=function(e,n){return s(e.text,n.startIndex)});var d=r(n,{find:e,wrap:c?null:i,replace:c?i:"$"+(a||"&"),prepMatch:function(e,n){if(!e[0])throw"findAndReplaceDOMText cannot handle zero-length matches";if(a>0){var t=e[a];e.index+=e[0].indexOf(t),e[0]=t}return e.endIndex=e.index+e[0].length,e.startIndex=e.index,e.index=n,e},filterElements:o});return t.revert=function(){return d.revert()},!0}function r(e,n){return new a(e,n)}function a(e,n){var i=n.preset&&t.PRESETS[n.preset];if(n.portionMode=n.portionMode||o,i)for(var r in i)u.call(i,r)&&!u.call(n,r)&&(n[r]=i[r]);this.node=e,this.options=n,this.prepMatch=n.prepMatch||this.prepMatch,this.reverts=[],this.matches=this.search(),this.matches.length&&this.processMatches()}var o="retain",c="first",s=P,d={}.toString,u={}.hasOwnProperty;return t.NON_PROSE_ELEMENTS={br:1,hr:1,script:1,style:1,img:1,video:1,audio:1,canvas:1,svg:1,map:1,object:1,input:1,textarea:1,select:1,option:1,optgroup:1,button:1},t.NON_CONTIGUOUS_PROSE_ELEMENTS={address:1,article:1,aside:1,blockquote:1,dd:1,div:1,dl:1,fieldset:1,figcaption:1,figure:1,footer:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,header:1,hgroup:1,hr:1,main:1,nav:1,noscript:1,ol:1,output:1,p:1,pre:1,section:1,ul:1,br:1,li:1,summary:1,dt:1,details:1,rp:1,rt:1,rtc:1,script:1,style:1,img:1,video:1,audio:1,canvas:1,svg:1,map:1,object:1,input:1,textarea:1,select:1,option:1,optgroup:1,button:1,table:1,tbody:1,thead:1,th:1,tr:1,td:1,caption:1,col:1,tfoot:1,colgroup:1},t.NON_INLINE_PROSE=function(e){return u.call(t.NON_CONTIGUOUS_PROSE_ELEMENTS,e.nodeName.toLowerCase())},t.PRESETS={prose:{forceContext:t.NON_INLINE_PROSE,filterElements:function(e){return!u.call(t.NON_PROSE_ELEMENTS,e.nodeName.toLowerCase())}}},t.Finder=a,a.prototype={search:function(){function e(n){for(var o=0,d=n.length;o<d;++o){var u=n[o];if("string"==typeof u){if(a.global)for(;t=a.exec(u);)c.push(s.prepMatch(t,i++,r));else(t=u.match(a))&&c.push(s.prepMatch(t,0,r));r+=u.length}else e(u)}}var t,i=0,r=0,a=this.options.find,o=this.getAggregateText(),c=[],s=this;return a="string"==typeof a?RegExp(n(a),"g"):a,e(o),c},prepMatch:function(e,n,t){if(!e[0])throw new Error("findAndReplaceDOMText cannot handle zero-length matches");return e.endIndex=t+e.index+e[0].length,e.startIndex=t+e.index,e.index=n,e},getAggregateText:function(){function e(i,r){if(3===i.nodeType)return[i.data];if(n&&!n(i))return[];var r=[""],a=0;if(i=i.firstChild)do{if(3!==i.nodeType){var o=e(i);t&&1===i.nodeType&&(!0===t||t(i))?(r[++a]=o,r[++a]=""):("string"==typeof o[0]&&(r[a]+=o.shift()),o.length&&(r[++a]=o,r[++a]=""))}else r[a]+=i.data}while(i=i.nextSibling);return r}var n=this.options.filterElements,t=this.options.forceContext;return e(this.node)},processMatches:function(){var e=this.matches,n=this.node,t=this.options.filterElements,i,r,a=[],o=n,c=e.shift(),s=0,d=0,u=0,l,h=[n];e:for(;;){if(3===o.nodeType&&(!r&&o.length+s>=c.endIndex?r={node:o,index:u++,text:o.data.substring(c.startIndex-s,c.endIndex-s),indexInMatch:s-c.startIndex,indexInNode:c.startIndex-s,endIndexInNode:c.endIndex-s,isEnd:!0}:i&&a.push({node:o,index:u++,text:o.data,indexInMatch:s-c.startIndex,indexInNode:0}),!i&&o.length+s>c.startIndex&&(i={node:o,index:u++,indexInMatch:0,indexInNode:c.startIndex-s,endIndexInNode:c.endIndex-s,text:o.data.substring(c.startIndex-s,c.endIndex-s)}),s+=o.data.length),l=1===o.nodeType&&t&&!t(o),i&&r){if(o=this.replaceMatch(c,i,a,r),s-=r.node.data.length-r.endIndexInNode,i=null,r=null,a=[],u=0,d++,!(c=e.shift()))break}else if(!l&&(o.firstChild||o.nextSibling)){o.firstChild?(h.push(o),o=o.firstChild):o=o.nextSibling;continue}for(;;){if(o.nextSibling){o=o.nextSibling;break}if((o=h.pop())===n)break e}}},revert:function(){for(var e=this.reverts.length;e--;)this.reverts[e]();this.reverts=[]},prepareReplacementString:function(e,n,t,i){var r=this.options.portionMode;return r===c&&n.indexInMatch>0?"":(e=e.replace(/\$(\d+|&|`|')/g,(function(e,n){var i;switch(n){case"&":i=t[0];break;case"`":i=t.input.substring(0,t.startIndex);break;case"'":i=t.input.substring(t.endIndex);break;default:i=t[+n]}return i})),r===c?e:n.isEnd?e.substring(n.indexInMatch):e.substring(n.indexInMatch,n.indexInMatch+n.text.length))},getPortionReplacementNode:function(e,n,t){var i=this.options.replace||"$&",r=this.options.wrap;if(r&&r.nodeType){var a=s.createElement("div");a.innerHTML=r.outerHTML||(new XMLSerializer).serializeToString(r),r=a.firstChild}if("function"==typeof i)return(i=i(e,n,t))&&i.nodeType?i:s.createTextNode(String(i));var o="string"==typeof r?s.createElement(r):r;return(i=s.createTextNode(this.prepareReplacementString(i,e,n,t))).data&&o?(o.appendChild(i),o):i},replaceMatch:function(e,n,t,i){var r=n.node,a=i.node,o,c;if(r===a){var d=r;n.indexInNode>0&&(o=s.createTextNode(d.data.substring(0,n.indexInNode)),d.parentNode.insertBefore(o,d));var u=this.getPortionReplacementNode(i,e);return d.parentNode.insertBefore(u,d),i.endIndexInNode<d.length&&(c=s.createTextNode(d.data.substring(i.endIndexInNode)),d.parentNode.insertBefore(c,d)),d.parentNode.removeChild(d),this.reverts.push((function(){o===u.previousSibling&&o.parentNode.removeChild(o),c===u.nextSibling&&c.parentNode.removeChild(c),u.parentNode.replaceChild(d,u)})),u}o=s.createTextNode(r.data.substring(0,n.indexInNode)),c=s.createTextNode(a.data.substring(i.endIndexInNode));for(var l=this.getPortionReplacementNode(n,e),h=[],p=0,f=t.length;p<f;++p){var g=t[p],b=this.getPortionReplacementNode(g,e);g.node.parentNode.replaceChild(b,g.node),this.reverts.push(function(e,n){return function(){n.parentNode.replaceChild(e.node,n)}}(g,b)),h.push(b)}var v=this.getPortionReplacementNode(i,e);return r.parentNode.insertBefore(o,r),r.parentNode.insertBefore(l,r),r.parentNode.removeChild(r),a.parentNode.insertBefore(v,a),a.parentNode.insertBefore(c,a),a.parentNode.removeChild(a),this.reverts.push((function(){o.parentNode.removeChild(o),l.parentNode.replaceChild(r,l),c.parentNode.removeChild(c),v.parentNode.replaceChild(a,v)})),v}},t}()),Ne=((Ce=Ee.create("div")).appendChild(Ee.create("","0-")),Ce.appendChild(Ee.create("","2")),Ce.normalize(),2!==Ce.firstChild.length),Ce;Ee.extend(we.fn,{normalize:function(){return Ne&&this.context.normalize(),this},jinzify:function(e){return this.filter(e||null).avoid("h-jinze").replace(_.jinze.touwei,(function(e,n){var t=Ee.create("h-jinze","touwei");return t.innerHTML=n[0],0===e.index&&e.isEnd||1===e.index?t:""})).replace(_.jinze.wei,(function(e,n){var t=Ee.create("h-jinze","wei");return t.innerHTML=n[0],0===e.index?t:""})).replace(_.jinze.tou,(function(e,n){var t=Ee.create("h-jinze","tou");return t.innerHTML=n[0],0===e.index&&e.isEnd||1===e.index?t:""})).replace(_.jinze.middle,(function(e,n){var t=Ee.create("h-jinze","middle");return t.innerHTML=n[0],0===e.index&&e.isEnd||1===e.index?t:""})).endAvoid().endFilter()},groupify:function(e){var e=Ee.extend({biaodian:!1,hanzi:!1,kana:!1,eonmun:!1,western:!1},e||{});return this.avoid("h-word, h-char-group"),e.biaodian&&this.replace(_.group.biaodian[0],i).replace(_.group.biaodian[1],i),(e.hanzi||e.cjk)&&this.wrap(_.group.hanzi,Ee.clone(Ee.create("h-char-group","hanzi cjk"))),e.western&&this.wrap(_.group.western,Ee.clone(Ee.create("h-word","western"))),e.kana&&this.wrap(_.group.kana,Ee.clone(Ee.create("h-char-group","kana"))),(e.eonmun||e.hangul)&&this.wrap(_.group.eonmun,Ee.clone(Ee.create("h-word","eonmun hangul"))),this.endAvoid(),this},charify:function(e){var e;return(e=Ee.extend({avoid:!0,biaodian:!1,punct:!1,hanzi:!1,latin:!1,ellinika:!1,kirillica:!1,kana:!1,eonmun:!1},e||{})).avoid&&this.avoid("h-char"),e.biaodian&&this.replace(_.char.biaodian.all,t(e.biaodian)||function(e){return r(e.text)}).replace(_.char.biaodian.liga,t(e.biaodian)||function(e){return r(e.text)}),(e.hanzi||e.cjk)&&this.wrap(_.char.hanzi,t(e.hanzi||e.cjk)||Ee.clone(Ee.create("h-char","hanzi cjk"))),e.punct&&this.wrap(_.char.punct.all,t(e.punct)||Ee.clone(Ee.create("h-char","punct"))),e.latin&&this.wrap(_.char.latin,t(e.latin)||Ee.clone(Ee.create("h-char","alphabet latin"))),(e.ellinika||e.greek)&&this.wrap(_.char.ellinika,t(e.ellinika||e.greek)||Ee.clone(Ee.create("h-char","alphabet ellinika greek"))),(e.kirillica||e.cyrillic)&&this.wrap(_.char.kirillica,t(e.kirillica||e.cyrillic)||Ee.clone(Ee.create("h-char","alphabet kirillica cyrillic"))),e.kana&&this.wrap(_.char.kana,t(e.kana)||Ee.clone(Ee.create("h-char","kana"))),(e.eonmun||e.hangul)&&this.wrap(_.char.eonmun,t(e.eonmun||e.hangul)||Ee.clone(Ee.create("h-char","eonmun hangul"))),this.endAvoid(),this}}),Ee.extend(F,{isNodeNormalizeNormal:Ne,find:we,createBDGroup:i,createBDChar:r}),Ee.matches=F.find.matches,["setMode","wrap","replace","revert","addBoundary","removeBoundary","avoid","endAvoid","filter","endFilter","jinzify","groupify","charify"].forEach((function(e){F.fn[e]=function(n,t){return this.finder||(this.finder=F.find(this.context)),this.finder[e](n,t),this}}));var Te={};Te.writeOnCanvas=o,Te.compareCanvases=c,Te.detectFont=s,Te.support=function(){function n(e){var n=e.charAt(0).toUpperCase()+e.slice(1),t,i;return(e+" "+r.join(n+" ")+n).split(" ").forEach((function(e){"string"==typeof a.style[e]&&(i=!0)})),i||!1}function t(e,n){var t=O||Ee.create("body"),i=Ee.create("div"),r=O?i:t,n="function"==typeof n?n:function(){},a,o,c;return a=["<style>",e,"</style>"].join(""),r.innerHTML+=a,t.appendChild(i),O||(t.style.background="",t.style.overflow="hidden",c=H.style.overflow,H.style.overflow="hidden",H.appendChild(t)),o=n(r,e),Ee.remove(r),O||(H.style.overflow=c),!!o}function i(n,t){var i;return e.getComputedStyle?i=P.defaultView.getComputedStyle(n,null).getPropertyValue(t):n.currentStyle&&(i=n.currentStyle[t]),i}var r="Webkit Moz ms".split(" "),a=Ee.create("h-test"),o;return{columnwidth:n("columnWidth"),fontface:(t('@font-face { font-family: font; src: url("//"); }',(function(e,n){var t=Ee.qsa("style",e)[0],i=t.sheet||t.styleSheet,r=i?i.cssRules&&i.cssRules[0]?i.cssRules[0].cssText:i.cssText||"":"";o=/src/i.test(r)&&0===r.indexOf(n.split(" ")[0])})),o),ruby:function(){var e=Ee.create("ruby"),n=Ee.create("rt"),t=Ee.create("rp"),r;return e.appendChild(t),e.appendChild(n),H.appendChild(e),r="none"===i(t,"display")||"ruby"===i(e,"display")&&"ruby-text"===i(n,"display"),H.removeChild(e),e=null,n=null,t=null,r}(),"ruby-display":function(){var e=Ee.create("div");return e.innerHTML='<h-test-a style="display: ruby;"></h-test-a><h-test-b style="display: ruby-text-container;"></h-test-b>',"ruby"===e.querySelector("h-test-a").style.display&&"ruby-text-container"===e.querySelector("h-test-b").style.display}(),"ruby-interchar":function(){var e="inter-character",n=Ee.create("div"),t;return n.innerHTML='<h-test style="-moz-ruby-position:'+e+";-ms-ruby-position:"+e+";-webkit-ruby-position:"+e+";ruby-position:"+e+';"></h-test>',(t=n.querySelector("h-test").style).rubyPosition===e||t.WebkitRubyPosition===e||t.MozRubyPosition===e||t.msRubyPosition===e}(),textemphasis:n("textEmphasis"),unicoderange:function(){var e;return t('@font-face{font-family:test-for-unicode-range;src:local(Arial),local("Droid Sans")}@font-face{font-family:test-for-unicode-range;src:local("Times New Roman"),local(Times),local("Droid Serif");unicode-range:U+270C}',(function(){e=!Te.detectFont("test-for-unicode-range",'Arial, "Droid Sans"',"Q")})),e}(),writingmode:n("writingMode")}}(),Te.initCond=function(e){var e=e||H,n="",t;for(var i in Te.support)t=(Te.support[i]?"":"no-")+i,e.classList.add(t),n+=t+" ";return n};var Se=Te.support["ruby-interchar"];Ee.extend(Te,{renderRuby:function(e,n){var n=n||"ruby",t=Ee.qsa(n,e);Ee.qsa("rtc",e).concat(t).map(p),t.forEach((function(e){var n=e.classList,t;n.contains("complex")?t=l(e):n.contains("zhuyin")&&(t=Se?u(e):d(e)),t&&e.parentNode.replaceChild(t,e)}))},simplifyRubyClass:p,getZhuyinHTML:b,renderComplexRuby:l,renderSimpleRuby:d,renderInterCharRuby:u}),Ee.extend(Te,{renderElem:function(e){this.renderRuby(e),this.renderDecoLine(e),this.renderDecoLine(e,"s, del"),this.renderEm(e)},renderDecoLine:function(e,n){var t=Ee.qsa(n||"u, ins",e),i=t.length;e:for(;i--;){var r=t[i],a=null;do{if(!(a=(a||r).previousSibling))continue e;t[i-1]===a&&r.classList.add("adjacent")}while(Ee.isIgnorable(a))}},renderEm:function(e,n){var t=n?"qsa":"tag",n=n||"em",i;Ee[t](n,e).forEach((function(e){var n=F(e);Te.support.textemphasis?n.avoid("rt, h-char").charify({biaodian:!0,punct:!0}):n.avoid("rt, h-char, h-char-group").jinzify().groupify({western:!0}).charify({hanzi:!0,biaodian:!0,punct:!0,latin:!0,ellinika:!0,kirillica:!0})}))}}),F.normalize=Te,F.localize=Te,F.support=Te.support,F.detectFont=Te.detectFont,F.fn.initCond=function(){return this.condition.classList.add("han-js-rendered"),F.normalize.initCond(this.condition),this},["Elem","DecoLine","Em","Ruby"].forEach((function(e){var n="render"+e;F.fn[n]=function(e){return F.normalize[n](this.context,e),this}})),Ee.extend(F.support,{heiti:!0,songti:F.detectFont('"Han Songti"'),"songti-gb":F.detectFont('"Han Songti GB"'),kaiti:F.detectFont('"Han Kaiti"'),fangsong:F.detectFont('"Han Fangsong"')}),F.correctBiaodian=function(e){var e=e||P,n=F.find(e);return n.avoid("h-char").replace(/([‘“])/g,(function(e){var n=F.createBDChar(e.text);return n.classList.add("bd-open","punct"),n})).replace(/([’”])/g,(function(e){var n=F.createBDChar(e.text);return n.classList.add("bd-close","bd-end","punct"),n})),F.support.unicoderange?n:n.charify({biaodian:!0})},F.correctBasicBD=F.correctBiaodian,F.correctBD=F.correctBiaodian,Ee.extend(F.fn,{biaodian:null,correctBiaodian:function(){return this.biaodian=F.correctBiaodian(this.context),this},revertCorrectedBiaodian:function(){try{this.biaodian.revert("all")}catch(e){}return this}}),F.fn.correctBasicBD=F.fn.correctBiaodian,F.fn.revertBasicBD=F.fn.revertCorrectedBiaodian;var Le="<<hws>>",ke=Ee.create("h-hws"),ze;ke.setAttribute("hidden",""),ke.innerHTML=" ",Ee.extend(F,{renderHWS:function(e,n){var t=n?"textarea, code, kbd, samp, pre":"textarea",i=n?"strict":"base",e=e||P,r=F.find(e);return r.avoid(t).replace(F.TYPESET.hws[i][0],y).replace(F.TYPESET.hws[i][1],y).replace(new RegExp("(<<hws>>)+","g"),x).replace(/([\'"])\s(.+?)\s\1/g,E).replace(/\s[‘“]/g,w).replace(/[’”]\s/g,w).normalize(),r}}),Ee.extend(F.fn,{renderHWS:function(e){return F.renderHWS(this.context,e),this},revertHWS:function(){return Ee.tag("h-hws",this.context).forEach((function(e){Ee.remove(e)})),this.HWS=[],this}});var Ie="bd-hangable",Me="h-char.bd-hangable",Re='<h-cs hidden class="jinze-outer hangable-outer"> </h-cs>',je=F.find.matches;F.support["han-space"]=N(),Ee.extend(F,{detectSpaceFont:N,isSpaceFontLoaded:N(),renderHanging:function(e){var e=e||P,n=F.find(e);return n.avoid("textarea, code, kbd, samp, pre").avoid(Me).replace(_.jinze.hanging,(function(e){if(/^[\x20\t\r\n\f]+$/.test(e.text))return"";var n=e.node.parentNode,t,i,r,a;return(t=Ee.parent(n,"h-jinze"))&&C(t),a=e.text.trim(),(i=F.createBDChar(a)).innerHTML="<h-inner>"+a+"</h-inner>",i.classList.add(Ie),(r=Ee.parent(n,"h-char.biaodian"))?(r.classList.add(Ie),je(n,"h-inner, h-inner *")?a:i.firstChild):i})),n}}),Ee.extend(F.fn,{renderHanging:function(){var e=this.condition.classList;return F.isSpaceFontLoaded=N(),F.isSpaceFontLoaded&&e.contains("no-han-space")&&(e.remove("no-han-space"),e.add("han-space")),F.renderHanging(this.context),this},revertHanging:function(){return Ee.qsa("h-char.bd-hangable, h-cs.hangable-outer",this.context).forEach((function(e){var n=e.classList;n.remove("bd-hangable"),n.remove("hangable-outer")})),this}});var Ae="bd-jiya",Pe="h-char.bd-jiya",He="bd-consecutive",Oe='<h-cs hidden class="jinze-outer jiya-outer"> </h-cs>',je=F.find.matches,Be,De;F.renderJiya=function(e){var e=e||P,n=F.find(e);return n.avoid("textarea, code, kbd, samp, pre, h-cs").avoid(Pe).charify({avoid:!1,biaodian:S
}).endAvoid().avoid("textarea, code, kbd, samp, pre, h-cs").replace(_.group.biaodian[0],L).replace(_.group.biaodian[1],L),n},Ee.extend(F.fn,{renderJiya:function(){return F.renderJiya(this.context),this},revertJiya:function(){return Ee.qsa("h-char.bd-jiya, h-cs.jiya-outer",this.context).forEach((function(e){var n=e.classList;n.remove("bd-jiya"),n.remove("jiya-outer")})),this}});var Fe="h-ru[annotation]",qe="textarea, code, kbd, samp, pre",Ue=Ee.create("h-char","comb-liga");return Ee.extend(F,{isVowelCombLigaNormal:M(),isVowelICombLigaNormal:R(),isZhuyinCombLigaNormal:j(),isCombLigaNormal:R()(),substVowelCombLiga:A(F.TYPESET["display-as"]["comb-liga-vowel"]),substZhuyinCombLiga:A(F.TYPESET["display-as"]["comb-liga-zhuyin"]),substCombLigaWithPUA:A(F.TYPESET["display-as"]["comb-liga-pua"]),substInaccurateChar:function(e){var e=e||P,n=F.find(e);n.avoid(qe),F.TYPESET["inaccurate-char"].forEach((function(e){n.replace(new RegExp(e[0],"ig"),e[1])}))}}),Ee.extend(F.fn,{"comb-liga-vowel":null,"comb-liga-vowel-i":null,"comb-liga-zhuyin":null,"inaccurate-char":null,substVowelCombLiga:function(){return this["comb-liga-vowel"]=F.substVowelCombLiga(this.context),this},substVowelICombLiga:function(){return this["comb-liga-vowel-i"]=F.substVowelICombLiga(this.context),this},substZhuyinCombLiga:function(){return this["comb-liga-zhuyin"]=F.substZhuyinCombLiga(this.context),this},substCombLigaWithPUA:function(){return F.isVowelCombLigaNormal()?F.isVowelICombLigaNormal()||(this["comb-liga-vowel-i"]=F.substVowelICombLiga(this.context)):this["comb-liga-vowel"]=F.substVowelCombLiga(this.context),F.isZhuyinCombLigaNormal()||(this["comb-liga-zhuyin"]=F.substZhuyinCombLiga(this.context)),this},revertVowelCombLiga:function(){try{this["comb-liga-vowel"].revert("all")}catch(e){}return this},revertVowelICombLiga:function(){try{this["comb-liga-vowel-i"].revert("all")}catch(e){}return this},revertZhuyinCombLiga:function(){try{this["comb-liga-zhuyin"].revert("all")}catch(e){}return this},revertCombLigaWithPUA:function(){try{this["comb-liga-vowel"].revert("all"),this["comb-liga-vowel-i"].revert("all"),this["comb-liga-zhuyin"].revert("all")}catch(e){}return this},substInaccurateChar:function(){return this["inaccurate-char"]=F.substInaccurateChar(this.context),this},revertInaccurateChar:function(){try{this["inaccurate-char"].revert("all")}catch(e){}return this}}),e.addEventListener("DOMContentLoaded",(function(){var e;H.classList.contains("han-init")?F.init():(e=P.querySelector(".han-init-context"))&&(F.init=F(e).render())})),void 0!==n&&!1!==n||(e.Han=F),F}));